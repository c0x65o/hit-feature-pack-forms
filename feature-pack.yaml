# Feature Pack: forms
# Runtime-configurable custom forms (builder + CRUD entries)

name: forms
description: Runtime Forms feature pack with builder + CRUD entries + search + reference linking

# Route definitions - mapped to React components
routes:
  - path: /forms
    page: FormList
    roles: []
  - path: /forms/new
    page: FormBuilder
    roles: []
  - path: /forms/[id]
    page: FormBuilder
    roles: []
  - path: /forms/[id]/entries
    page: EntryList
    roles: []
  - path: /forms/[id]/entries/new
    page: EntryEdit
    roles: []
  - path: /forms/[id]/entries/[entryId]
    page: EntryDetail
    roles: []
  - path: /forms/[id]/entries/[entryId]/edit
    page: EntryEdit
    roles: []

# Navigation contributions
nav:
  - id: forms
    label: Forms
    path: /forms
    icon: ClipboardList
    group: main
    showWhen: authenticated
    weight: 160

# Schema contributions (Drizzle tables)
schema:
  source: src/schema/forms.ts
  exports: [forms, formVersions, formFields, formEntries, formEntryHistory]

# API routes expected by this pack
# Handlers are exported from the feature pack and imported at runtime
api:
  routes:
    - path: /api/forms
      methods: [GET, POST]
      handler: "@hit/feature-pack-forms/server/api/forms"
      description: "List forms (GET) or create form (POST)"
    - path: /api/forms/[id]
      methods: [GET, PUT, DELETE]
      handler: "@hit/feature-pack-forms/server/api/forms-id"
      description: "Get, update, or delete a form"
    - path: /api/forms/[id]/publish
      methods: [POST]
      handler: "@hit/feature-pack-forms/server/api/publish"
      description: "Publish a form version"
    - path: /api/forms/[id]/unpublish
      methods: [POST]
      handler: "@hit/feature-pack-forms/server/api/unpublish"
      description: "Unpublish a form"
    - path: /api/forms/[id]/entries
      methods: [GET, POST]
      handler: "@hit/feature-pack-forms/server/api/entries"
      description: "List entries (GET) or create entry (POST)"
    - path: /api/forms/[id]/entries/[entryId]
      methods: [GET, PUT, DELETE]
      handler: "@hit/feature-pack-forms/server/api/entries-id"
      description: "Get, update, or delete an entry"

requires:
  modules: []

dependencies:
  feature_packs:
    - name: dashboard-shell

# Configurable options (currently kept minimal; scope is stored per-form at runtime)
config:
  schema:
    default_scope:
      type: string
      default: private
      enum: [private, project]
      description: "Default scope for newly created forms. private: owner-only, project: all authenticated users."
    enable_history:
      type: boolean
      default: true
      description: "Write entry snapshots on update/delete."
    enable_reference_fields:
      type: boolean
      default: true
      description: "Enable reference field type and picker UI."
